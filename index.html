<!DOCTYPE HTML>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html;charset=UTF-8" />
		<style type="text/css">
			a {
				color:				#5070B0;
				text-decoration:	none;
			}

			a:hover {
				color:				#6080C0;
				text-decoration:	underline;
			}

			body {
				padding:	0px;
				margin:		32px 64px;
				font:		normal normal normal 0.9em 'Trebuchet MS', Helvetica, sans-serif;
			}

			div.code {
				position:		relative;
				padding:		10px 6px 1px 6px;
				margin:			12px 8px;
				background:		#D0E0F0;
				border-top:		1px solid #80A0B0;
				border-right:	1px solid #A0C0D0;
				border-bottom:	1px solid #A0C0D0;
				border-left:	1px solid #80A0B0;
				border-radius:	6px;
			}

			div.code code {
				font:			normal normal normal 1.0em monospace;
				white-space:	pre;
			}

			div.code code strong {
				background:		#D0C0B0;
				font-weight:	bold;
			}

			div.code blockquote {
				position:	relative;
				top:		-18px;
				height: 	0px;
				padding:	0px;
				margin:		0px;
			}

			div.code blockquote span {
				padding:		0px 4px 0px 5px;
				background:		#B0C6E0;
				border-top:		1px solid #C0D0F0;
				border-right:	1px solid #A0B0C0;
				border-bottom:	1px solid #A0B0C0;
				border-left:	1px solid #C0D0F0;
				border-radius:	6px;
				font-size:		0.7em;
				font-weight:	bold;
			}

			div.s1 {
				margin:		8px 0px 48px 0px;
			}

			div.s2 {
				margin:		8px 0px 32px 0px;
			}

			div.s3 {
				margin:		8px 0px 24px 0px;
			}

			h1 {
				padding:	0px;
				margin:		24px 8px;
				text-align:	center;				
				font-size:	2.0em;
				color:		#4060A0;
			}

			h2 {
				padding:	0px;
				margin:		8px 16px;
				font-size:	1.4em;
				color:		#5070B0;
			}

			h3 {
				padding:	0px;
				margin:		8px 24px;
				font-size:	1.0em;
				color:		#6080C0;
			}

			p {
				margin:	12px 8px;
			}

			ul {
				padding:	4px 32px;
				margin:		8px 0px;
				list-style:	circle;
			}

			ul ul {
				padding:	0px 32px;
				margin:		0px;
			}

			p code, ul code {
				background:	#E0E0E0;
				font:		normal normal normal 1.0em monospace;
			}
		</style>
		<title>Cottle Documentation</title>
	</head>
	<body>
		<h1>Cottle Documentation</h1>
		<div class="s1" id="toc-from">
			<h2>Table of contents</h2>
			<div class="s2" id="toc-data">
				<ul>
				</ul>
			</div>

			<h2>Cottle overview</h2>
			<div class="s2">
				<h3>What is Cottle, and what does it looks like?</h3>
				<div class="s3">
					<p>Cottle, short for "<u>C</u>ompact <u>O</u>bject to
					<u>T</u>ext <u>T</u>ransform <u>L</u>anguag<u>e</u>" is a
					lightweight template engine in .NET 3.5 allowing you to
					transform structured data into any text-based format
					output like plain text, HTML or XML. It uses a simple yet
					highly extensible template language, thus enabling clean
					separation of document content (data structure) and
					document presentation.</p>
					<p>A simple Cottle template printing an HTML document
					showing how many messages are in your mailbox could look
					like this:</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>&lt;html&gt;
    &lt;body&gt;
        &lt;h1&gt;Hello, {name}!&lt;/h1&gt;
        &lt;p&gt;
            {if gt(count(messages),0):
                You have {count(messages)} new message{if gt(count(messages),1):s} in your mailbox!
            |else:
                You have no new message.
            }
        &lt;/p&gt;
    &lt;/body&gt;
&lt;/html&gt;</code>
					</div>
					<p>As you can guess by looking at this code, a Cottle
					template contains both "raw" text printed directly and
					special tags used to control how text output is generated.
					Cottle supports most common template engine features, such
					as:</p>
					<ul>
						<li>Text substitutions through variables,</li>
						<li>Builtin and used-defined functions,</li>
						<li>Variable & function declaration and
						assignments,</li>
						<li>Conditional statements (if),</li>
						<li>Loops (for, while).</li>
					</ul>
					<p>Source code is available, and contributions will be
					highly welcomed!</p>
				</div>

				<h3>Download the library</h3>
				<div class="s3">
					<p>You can download the last version of Cottle on Github,
					by following this link:
					<a href="https://github.com/r3c/Cottle">https://github.com/r3c/Cottle</a>.</p>
				</div>

				<h3>About this documentation</h3>
				<div class="s3">
					<p>This document intent to explain how Cottle works, how to
					write templates and how to use them in your code. Some
					features are introduced with a code sample, and some
					guidelines have been followed to ease readability.</p>
					<p>Using Cottle requires an input template, which could be
					streamed from any source compatible with
					<code>System.IO.TextReader</code> class (text file, memory
					buffer, network socket...), and an executable code that
					parse the template into a <code>Cottle.Document</code>
					instance, then renders it into an output string or writer.
					These three parts will be shown in examples as follows:</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>Text contents of the template file 'template.ctl'.</code>
					</div>
					<div class="code">
						<blockquote><span>C# code:</span></blockquote>
<code>Document   document;
Scope      scope;

using (StreamReader template = new StreamReader(new FileStream("template.ctl", FileMode.Open), Encoding.UTF8))
{
    document = new Document(template);
}

scope = new Scope();

/* assign values to scope here */

document.Render(scope, Console.Out);</code>
					</div>
					<div class="code">
						<blockquote><span>Result:</span></blockquote>
<code>Text contents of the template file 'template.ctl'.</code>
					</div>
					<p>Since the sample C# codes used in example is quite
					redundant, only the specific parts for each one will appear
					in examples and should be inserted where indicated by a
					comment in the sample above. Common parts of the code won't
					be shown anymore.
					</p>
				</div>
			</div>
			
			<h2>Template fundamentals</h2>
			<div class="s2">
				<h3>Simple raw text output</h3>
				<div class="s3">
					<p>Everything you type into a Cottle template will be
					printed "as is" in the result document, except for some
					special characters. That means raw text will appear exactly
					as you entered it in your template, as shown in this
					example:</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>Hello, world!</code>
					</div>
					<div class="code">
						<blockquote><span>Result:</span></blockquote>
<code>Hello, world!</code>
					</div>
				</div>

				<h3>Sending variables to template</h3>
				<div class="s3">
					<p>To send variables to parsed document so they can be used
					while rendering, you must use a <code>Cottle.Scope</code>
					instance that will hold them. This class behaves quite like
					a <code>Dictionary&lt;Cottle.Value,Cottle.Value&gt;</code>,
					where <code>Cottle.Value</code> is an internal Cottle type.
					Key and value pairs within this dictionary are used as
					variable names and associated values. Implicit constructors
					from some native .NET types to <code>Value</code> type are
					provided so most of the time you won't have to explicitly
					build <code>Value</code> objects yourself, but you can
					check in <code>Cottle.Values</code> namespace for available
					types.</p>

					<p>Once assigned, variables can be used in the template,
					for example by using the <code>echo</code> command that
					prints the value of its argument: </p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>Hello {echo name}, you have no new message.</code>
					</div>
					<div class="code">
						<blockquote><span>C# code:</span></blockquote>
<code>scope["name"] = "John";</code>
					</div>
					<div class="code">
						<blockquote><span>Result:</span></blockquote>
<code>Hello John, you have no new message.</code>
					</div>
					<p>As <code>echo</code> is the default command, you can
					omit the "echo" keyword if the name of the variable you
					want to print doesn't conflict with another command:
					<code>{echo name}</code> is equivalent to
					<code>{name}</code> in this example. This shorter form
					will be used in all incoming samples.</p>
				</div>

				<h3>Escaping special characters</h3>
				<div class="s3">
					<p>There are four special characters that won't be printed
					unless you escape them, since they're used by template
					parser to trigger special behaviours. Special characters
					are:</p>
					<ul>
						<li>{ and }  (opening and closing braces),</li>
						<li>| (pipe),</li>
						<li>\ (backslash).</li>
					</ul>
					<p>If you need to print one of these in your template, you
					must preceed them with a backslash character:</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>Special characters \{, \}, \| and \\ must be escaped.</code>
					</div>
					<div class="code">
						<blockquote><span>Result:</span></blockquote>
<code>Special characters {, }, | and \ must be escaped.</code>
					</div>
				</div>

				<h3>Using array values</h3>
				<div class="s3">
					<p>Array values contain multiple values stored as key/value
					pairs. Keys and values can be scalar values, or other
					nested array values. Values within an array value can be
					accessed by their key, using either dotted or subscript
					notation:</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>You can use either {myarray.f1} or {myarray["f2"]} notations for array values.</code>
					</div>
					<div class="code">
						<blockquote><span>C# code:</span></blockquote>
<code>scope["myarray"] = new Dictionary&lt;Value,Value&gt;
{
    {"f1", "dotted"},
    {"f2", "subscript"}
};</code>
					</div>
					<div class="code">
						<blockquote><span>Result:</span></blockquote>
<code>You can use either dotted or subscript notations for array values.</code>
					</div>
					<p>Please node the quotes used in subscript notation.
					Trying to access value of <code>{myarray[f2]}</code> will
					result in a very different behavior, since it will search
					for the value whose key is the value of <code>f2</code>
					(which hasn't be defined), leading to an undefined
					result.</p>
					<p>If the keys of two or more pairs are equal, only the
					value of the last one can be accessed directly. However,
					the other pairs can still be retrieved with different
					methods as we'll see later.</p>
				</div>

				<h3>Literals and variables</h3>
				<div class="s3">
					<p>All commands in Cottle, like <code>echo</code>, must be
					called with values as arguments. These arguments can be
					names of variables you set through .NET code before
					rendering the template, constant literals, or any
					expression returning a value (this last case will be
					explained in details later in this document).</p>
					<p>Here is how to use literal values in your templates:</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>{17}
{"Constant string value"}
{["key1": "value1", "key2": "value2", 43: "value for key 43"]}
{["constant", "array", "with", "auto-generated", "numeric", "keys"]}
{[1: ["array", "with"], "mixed": "values"]}</code>
					</div>
				</div>

				<h3>Calling functions</h3>
				<div class="s3">
					<p>Functions in Cottle are special values that can be
					called just like functions in any programming language,
					using this syntax:</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>You have {count(messages)} new message(s) in your inbox.</code>
					</div>
					<div class="code">
						<blockquote><span>C# code:</span></blockquote>
<code>CommonFunctions.Assign(scope);

scope["messages"] = new Dictionary&lt;Value,Value&gt;
{
    {0, "message #0"},
    {1, "message #1"},
    {2, "message #2"}
};</code>
					</div>
					<div class="code">
						<blockquote><span>Result:</span></blockquote>
<code>You have 3 new message(s) in your inbox.</code>
					</div>
					<p>Please note the use of
					<code>CommonFunctions.Assign</code> method. When a new
					<code>Scope</code> instance is created, it does not contain
					any value (and does not contain any function either, since
					functions are values). While this gives you full control of
					which functions you want to make available from your
					template files, you may want to start with a set of common
					predefined functions, and that's what
					<code>CommonFunctions.Assign</code> is made for: it just
					fills given <code>Scope</code> object with some useful
					functions, like <code>count</code> we used in previous
					example.</p>
					<p>To get a description of each of the functions set
					when using <code>CommonFunctions.Assign</code>, see
					paragraph
					"<a href="#common_functions">Common functions</a>". For all
					following samples, we'll assume that common functions are
					assigned before template is rendered.</p>
				</div>

				<h3>Commenting your templates</h3>
				<div class="s3">
					<p>You can use the <code>_</code> (underscore) command to
					add comments to your template. This command should be
					followed by a literal string (characters between quotes),
					and won't print any result when template is rendered.</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>{_ "This is a comment that will be ignored when rendering the template"}
Hello, World!</code>
					</div>
					<div class="code">
						<blockquote><span>Result:</span></blockquote>
<code>Hello, World!</code>
					</div>
				</div>
			</div>

			<h2>Flow control</h2>
			<div class="s2">
				<h3>Conditional statements</h3>
				<div class="s3">
					<p>You can write conditional statements by using the
					<code>if</code> command which evaluate the value of a
					variable (or the result of a function call) to check if its
					body should be printed or not. The <code>if</code> command
					also supports optional <code>elif</code> (else if) and
					<code>else</code> blocks that behave like in any
					programming language.</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>{if 1:
    A condition on a numerical value is true if the value is non-zero.
}

{if test: Variable "test" is true! |else: Variable "test" is false! }

{if gt(count(items), 2):
    There are more than two items in array ({count(items)}, actually).
}

{if lt(x, 0):
    X is negative.
|elif gt(x, 0):
    X is positive.
|else:
    X equals zero.
}</code>
					</div>
					<div class="code">
						<blockquote><span>C# code:</span></blockquote>
<code>scope["items"] = new Dictionary&lt;Value,Value&gt;
{
    {0, "item #0"},
    {1, "item #1"},
    {2, "item #2"}
};

scope["test"] = 42;
scope["x"] = -3;</code>
					</div>
					<div class="code">
						<blockquote><span>Result:</span></blockquote>
<code>A condition on a numerical value is true if the value is non-zero.

Variable "test" is true!

There are more than two items in array (3, actually).

X is negative.</code>
					</div>
					<p>Any undefined result, empty string, 0 or empty array
					will be evaluated to "false" when used in conditional
					statements. Other values will be considered as "true".</p>
				</div>

				<h3>Arrays enumeration</h3>
				<div class="s3">
					<p>Pairs contained within an array value can be enumerated
					with the <code>for</code> command, that will print its body
					for each key/value pair it found. An alternative syntax can
					be used if you only want to iterate on values and don't
					care about keys. The <code>for</code> command also supports
					an optional <code>empty</code> block printed when the array
					you tried to enumerate doesn't contain any key/value
					pair.</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>{for index, text in messages:
    Message #{add(index, 1)}: {text}
|empty:
    No messages to display.
}

Tags: {for tag in tags:{tag} }</code>
					</div>
					<div class="code">
						<blockquote><span>C# code:</span></blockquote>
<code>scope["messages"] = new Dictionary&lt;Value,Value&gt;
{
    {0, "Hi, this is a sample message!"},
    {1, "Hi, me again!"},
    {2, "Hi, guess what?"}
};

scope["tags"] = new Value[]
{
    "action",
    "horror",
    "fantastic"
};</code>
					</div>
					<div class="code">
						<blockquote><span>Result:</span></blockquote>
<code>Message #1: Hi, this is a sample message!
Message #2: Hi, me again!
Message #3: Hi, guess what?

Tags: action horror fantastic</code>
					</div>
				</div>

				<h3 id="variables_assignment">Variables assignment</h3>
				<div class="s3">
					<p>You can assign variables while template is being
					rendered by using the <code>set</code> command. Variable
					assignment allows you improve performance by storing
					evaluation results (such as function calls) that are going
					to be used several times, or code complex template
					mechanism by combining the <code>if</code>,
					<code>for</code> and <code>set</code> commands.</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>{set nb_msgs to count(messages)}

{if gt(nb_msgs,0):
    You have {nb_msgs} new message{if gt(nb_msgs, 1):s} in your mailbox!
|else:
    You have no new message.
}

{set nb_long to 0}

{for message in messages:
    {if gt(len(message), 20):
        {set nb_long to add(nb_long, 1)}
    }
}

{nb_long} message{if gt(nb_long, 1):s is|else:" "are} more than 20 characters long.</code>
					</div>
					<div class="code">
						<blockquote><span>C# code:</span></blockquote>
<code>scope["messages"] = new Dictionary&lt;Value,Value&gt;
{
    {0, "Hi, this is a sample message!"},
    {1, "Hi, me again!"},
    {2, "Hi, guess what?"}
};</code>
					</div>
					<div class="code">
						<blockquote><span>Result:</span></blockquote>
<code>You have 3 new messages in your mailbox!

1 message is more than 20 characters long.</code>
					</div>
					<p>You can assume that all variables are set in a global
					common scope. More advanced use of variable assignments
					will be explained later in this document.</p>
				</div>

				<h3>Loops</h3>
				<div class="s3">
					<p>The <code>while</code> command is the equivalent of the
					"while" keyword in most programming languages. Be sure to
					check for a condition that will become false after a finite
					number of iterations, or rendering of your template will
					never complete. When possible, prefer the use of the
					<code>for</code> command over <code>while</code>.</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>{set password to ""}
{set nb to rand(8, 16)}
{set i to 0}

{while lt(i, nb):
    {set ascii to rand(62)}

    {if lt(ascii, 10):
        {set password to cat(password, char(add(ascii, ord("0"))))}
    |elif lt(ascii, 36):
        {set password to cat(password, char(add(sub(ascii, 10), ord("A"))))}
    |else:
        {set password to cat(password, char(add(sub(ascii, 36), ord("a"))))}
    }

    {set i to add(i, 1)}
}

Your random password is: {password}.</code>
					</div>
					<div class="code">
						<blockquote><span>Result:</span></blockquote>
<code>Your random password is: 2PIBnodftxz8jAX.</code>
					</div>
				</div>
			</div>

			<h2>Advanced topics</h2>
			<div class="s2">
				<h3>Variable contents inspection</h3>
				<div class="s3">
					<p>When your template doesn't render as you would expect,
					the <code>dump</code> command can help you identify issues
					by showing value in a "printable" form. Undefined values,
					for example, won't print anything when passed through the
					<code>echo</code> command, but will appear as
					<code>&lt;undefined&gt;</code> with <code>dump</code>.</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>{dump "string"}
{dump 42}
{dump unknown(3)}
{dump [856, "hello", "x": 17]}</code>
					</div>
					<div class="code">
						<blockquote><span>Result:</span></blockquote>
<code>"string"
42
&lt;undefined&gt;
[0: 856, 1: "hello", "x": 17]</code>
					</div>
				</div>

				<h3>Functions declaration</h3>
				<div class="s3">
					<p>Cottle allows you to declare functions, that are
					callable values you can use to factor code as you would do
					in a program. To declare a function and assign it to a
					variable, use the <code>define</code> command that behaves
					quite like <code>set</code> but have a slightly different
					syntax. Function arguments are specified between
					parenthesis right after the variable name that should
					receive the function, followed by <code>as</code> and
					function body declaration.</p>
					<p>Functions can return a value that can be used in any
					expression or stored in a variable. To make a function halt
					and return a value, use the <code>return</code> command
					within its body.</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>{define factorial(n) as:
    {if gt(n, 1):
        {return mul(n, factorial(sub(n, 1)))}
    |else:
        {return 1}
    }
}

Factorial 1 = {factorial(1)}
Factorial 3 = {factorial(3)}
Factorial 8 = {factorial(8)}

{define hanoi_rec(n, from, by, to) as:
    {set n to sub(n, 1)}

    {if gt(n, 0): {hanoi_rec(n, from, to, by)}}
Move one disk from {from} to {to}
    {if gt(n, 0): {hanoi_rec(n, by, from, to)}}
}

{define hanoi(n) as:
    {hanoi_rec(n, "A", "B", "C")}
}

{hanoi(3)}</code>
					</div>
					<div class="code">
						<blockquote><span>Result:</span></blockquote>
<code>Factorial 1 = 1
Factorial 3 = 6
Factorial 8 = 40320

Move one disk from A to C
Move one disk from A to B
Move one disk from C to B
Move one disk from A to C
Move one disk from B to A
Move one disk from B to C
Move one disk from A to C</code>
					</div>
					<p>You can see in this example that returning a value and
					printing text are two very different things. Raw text
					within function body is printed each time the function is
					called, or more precisely each time its enclosing block is
					executed (that means it won't print if contained in an
					<code>if</code> command that fails to pass, for example).
					The value returned by the function won't be printed unless
					you explicitly require it by using the <code>echo</code>
					command (e.g. something like <code>{factorial(8)}</code>).
					If a function doesn't use any <code>return</code> command,
					the value it returns is empty, that's why the call to
					<code>{hanoi(3)}</code> in the sample above does not print
					anything more than the raw text blocks it contains.</p>
				</div>

				<h3>Variables scopes</h3>
				<div class="s3">
					<p>When writing complex templates using nested or recursive
					functions, you may have to take care of variable scopes to
					avoid potential issues. A scope is the local evaluation
					context of any function or command that have a body. When
					assigning a value to a variable as described in paragraph
					"<a href="#variables_assignment">Variables assignment</a>",
					all variables belong to the same top-level scope. Consider
					this template:</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>{define depth(item) as:
    {set res to 0}

    {for child in item:
        {set res_child to add(depth(child), 1)}
        {set res to max(res, res_child)}
    }

    {return res}
}

{depth([["1.1", "1.2", ["1.3.1", "1.3.2"]], "2", "3", ["4.1", "4.2"]])}</code>
					</div>
					<p>The <code>depth</code> function is expected to return
					the level of the deepest element in a value that contains
					nested arrays. Of course it could be written in a much more
					efficient way without using non necessary temporary
					variables, but it would hide the problem we want to
					illustrate. Anyway, we want this code to return a valid
					result, and if you try to execute it you'll notice that it
					returns <code>2</code> where <code>3</code> would have been
					expected.</p>
					<p>Here is the explanation: when using the <code>set</code>
					method to assign a value to variable <code>res</code>, it
					always uses the same <code>res</code> instance.
					The <code>depth</code> function recursively calls itself
					but overwrite the unique <code>res</code> variable each
					time it tries to store a value in it, and therefore fails
					to store the actual deepest level as it should. To solve
					this issue, the <code>res</code> variable needs to be local
					to function <code>depth</code>, that means each call to
					<code>depth</code> must use its own <code>res</code>
					instance.</p>
					<p>For that reason, the <code>set</code> command actually
					supports two assignment modes:</p>
					<ul>
						<li>When using <code>{set x to 1}</code>, Cottle
						searches for <code>x</code> in parent scopes bottom-up
						(from inner to outer), or create it in global scope if
						not found.</li>
						<li>When using <code>{set x as 1}</code>, Cottle
						searches for <code>x</code> in current scope, or create
						it in current scope if not found.</li>
					</ul>
					<p>To fix our previous example, <code>set</code> must be
					used with the <code>as</code> keyword before the if
					<code>for</code> block, to initialize a new local
					<code>res</code> variable. For next uses of
					<code>set</code>, the <code>to</code> keyword will still be
					used since it will now resolve to local
					<code>res</code>:</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>{define depth(item) as:
    {set res <strong>as</strong> 0}

    {for child in item:
        {set res_child to add(depth(child), 1)}
        {set res to max(res, res_child)}
    }

    {return res}
}

{depth([["1.1", "1.2", ["1.3.1", "1.3.2"]], "2", "3", ["4.1", "4.2"]])}</code>
					</div>
					<p>We only replaced the first <code>to</code> keyword, not
					the two others. By replacing all the <code>to</code>
					keywords by <code>as</code>, we would have created a new
					local <code>res</code> instance within the <code>for</code>
					command, making our previous <code>res</code> instance
					unused and always equal to its initial value of
					<code>0</code>.</p>
					<p>Note that the <code>define</code> command also supports
					the two keywords <code>as</code> and <code>to</code> for
					the same reasons.</p>
				</div>

				<h3>Custom .NET methods</h3>
				<div class="s3">
					<p>If you need new features or improved performance, you
					can assign your own .NET methods to template variables.
					That's actually what Cottle does each time you call
					<code>CommonFunctions.Assign</code>: a set of internal
					.NET methods is assigned to predefined variables within
					given scope, you can have a look at source code to see how
					these methods work.</p>
					<p>To assign a method to a scope, just wrap it within a
					<code>CallbackFunction</code> object contained by a
					<code>FunctionValue</code> object, then add it to the
					<code>Value</code> property of your <code>Document</code>
					instance, as you would do for any regular variable:</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>Testing custom "repeat" function:

{repeat("a", 15)}
{repeat("hello! ", 3)}
{repeat("-", 10)}</code>
					</div>
					<div class="code">
					<blockquote><span>C# code:</span></blockquote>
<code>scope["repeat"] = new FunctionValue (new CallbackFunction (delegate (IList&lt;Value&gt; values, Scope scope, TextWriter output)
{
    StringBuilder builder = new StringBuilder();
    int           i;

    for (i = 0; i &lt; values[1].AsNumber; ++i)
        builder.Append(values[0].AsString);

    return builder.ToString();
}, 2));</code>
					</div>
					<div class="code">
						<blockquote><span>Result:</span></blockquote>
<code>Testing custom "repeat" function:

aaaaaaaaaaaaaaa
hello! hello! hello! 
----------</code>
					</div>
					<p>Your custom .NET method must take three arguments:</p>
					<ul>
						<li>The list of arguments passed to the function
						(values),</li>
						<li>Current variables scope (scope),</li>
						<li>Document text writer object (output).</li>
					</ul>
					<p>Arguments are instances of the <code>Value</code> class,
					which can hold data of any type known by Cottle. You can
					access their <code>AsBoolean</code>,
					<code>AsFunction</code>, <code>AsNumber</code> and
					<code>AsString</code> properties to get data of desired
					type (automatic type conversion will be performed if
					needed). You can also use the <code>Type</code> property to
					know which data type a <code>Value</code> instance is
					actually holding. The <code>Fields</code> property contains
					all key/value pairs.</p>
					<p>In most cases you won't use scope and output text
					writer, but may need them if you want to run a function
					evaluation within your code. The text writer instance can
					however be used if you want your function to print
					something.</p>
					<p>The <code>CallbackFunction</code> objects also takes 2
					more optional arguments, used to indicate how many
					arguments are expected for your function. You can either
					ignore those arguments (and check yourself how many
					values your function received), specify an exact number of
					expected arguments, or specify min/max boundaries (-1 as a
					max boundary means "unlimited"). When specifying expected
					arguments count, Cottle will perform this check for you
					each time your function is invoked and ignore the call on
					error.</p>
					<p>Your custom function is expected to return a
					<code>Value</code> object. Remember that implicit
					constructors are available, so returning a compatible .NET
					native type is valid too.</p>
				</div>

				<h3>Block delimiters customization</h3>
				<div class="s3">
					<p>By default, Cottle uses { character to start a code
					block, | to continue it (before an <code>else</code>
					statement for example), and } to end it. These characters
					may not be a good choice if you want to write a template
					that makes extensive literal use of them, for example if
					you're writing a JavaScript template, because you would
					have to escape every {, } and | to avoid Cottle seeing them
					as block delimiters.</p>
					<p>To workaround this problem, you can change default block
					delimiters when creating a new document. New delimiters can
					be any string and won't be validated by Cottle, so you
					should avoid anything ambiguous otherwise the parser may
					not be able to understand your code. For example, choosing
					the ] character as a delimiter is a bad idea, as it will
					conflict with internal end-of-array delimiter.</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>Block delimiters are now &lt;&lt;block_begin&gt;&gt; and &lt;&lt;block_end&gt;&gt;.</code>
					</div>
					<div class="code">
						<blockquote><span>C# code:</span></blockquote>
<code>Document       document;
LexemConfig    config;
Scope          scope;

config = new LexemConfig();
config.BlockBegin = "&lt;&lt;";
config.BlockEnd = "&gt;&gt;";

using (StreamReader template = new StreamReader(new FileStream("template.ctl", FileMode.Open), Encoding.UTF8))
{
    document = new Document(template, config);
}

scope = new Scope();
scope["block_begin"] = config.BlockBegin + " (double lower-than)";
scope["block_end"] = config.BlockEnd + " (double greater-than)";

document.Render(scope, Console.Out);</code>
					</div>
					<div class="code">
						<blockquote><span>Result:</span></blockquote>
<code>Block delimiters are now &lt;&lt; (double lower-than) and &gt;&gt; (double greater-than) characters.</code>
					</div>
				</div>
			</div>

			<h2 id="common_functions">Common functions</h2>
			<div class="s2">
				<h3>Absolute value: abs(numeric)</h3>
				<div class="s3">
					<p>Return the absolute value of given numeric value.</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>{abs(-3)}
{abs(5)}</code>
					</div>
					<div class="code">
						<blockquote><span>Result:</span></blockquote>
<code>3
5</code>
					</div>
				</div>

				<h3>Compute sum of two values: add(a, b)</h3>
				<div class="s3">
					<p>Return the sum of two numeric values.</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>{add(3, 7)}</code>
					</div>
					<div class="code">
						<blockquote><span>Result:</span></blockquote>
<code>10</code>
					</div>
				</div>

				<h3>Logical AND: and(a, b, ...)</h3>
				<div class="s3">
					<p>Perform logical "and" between given boolean values, i.e.
					return "true" if every argument is true.</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>{and(lt(2, 3), gt(5, 1))}</code>
					</div>
					<div class="code">
						<blockquote><span>Result:</span></blockquote>
<code>true</code>
					</div>
				</div>

				<h3>Concatenate values: cat(a, b, ...)</h3>
				<div class="s3">
					<p>Concatenate all input values into a single one. This
					function works on string and arrays.</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>{cat("Hello, ", "World!")}
{for v in cat([1, 2], [3]): {v}}</code>
					</div>
					<div class="code">
						<blockquote><span>Result:</span></blockquote>
<code>Hello, World!
1 2 3</code>
					</div>
				</div>

				<h3>Get character from unicode value: char(int)</h3>
				<div class="s3">
					<p>Get a 1-character string from its unicode value. See
					<a href="http://en.wikipedia.org/wiki/Unicode">Unicode on
					Wikipedia</a> for details.</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>{char(97)}</code>
					</div>
					<div class="code">
						<blockquote><span>Result:</span></blockquote>
<code>a</code>
					</div>
				</div>

				<h3>Compare two values: cmp(a, b)</h3>
				<div class="s3">
					<p>Compare value a against b, and return -1 if a is lower
					than b, 0 if they're equal, or 1 else. When used on
					numeric values, the <code>cmp</code> function uses
					numerical order. When used on strings, it uses
					alphabetical order. When used on arrays, it first compare
					their lengths then compare their values two by two.</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>{cmp("abc", "bcd")}
{cmp(9, 6)}
{cmp([2, 4], [2, 4])}</code>
					</div>
					<div class="code">
						<blockquote><span>Result:</span></blockquote>
<code>-1
1
0</code>
					</div>
				</div>

				<h3>Filter pairs in an array: cross(array1, array2, ...)</h3>
				<div class="s3">
					<p>Return an array containing all pairs from
					<code>array1</code> having a key that also exists in
					<code>array2</code> and following arrays. Output pair
					values will always be taken from <code>array1</code>.</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>{dump cross([1: "a", 2: "b", 3: "c"], [1: "x", 3: "y"])}</code>
					</div>
					<div class="code">
						<blockquote><span>Result:</span></blockquote>
<code>[1: "a", 3: "c"]</code>
					</div>
				</div>

				<h3>Get input value or default value: default(test[, fallback])</h3>
				<div class="s3">
					<p>Return <code>test</code> if it would have satisfied an
					<code>if</code> condition, or <code>fallback</code> else
					(or an undefined value if <code>fallback</code> is
					missing).</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>{set x to 3}
{dump default(x, "invisible")}
{dump default(y, "visible")}</code>
					</div>
					<div class="code">
						<blockquote><span>Result:</span></blockquote>
<code>"visible"</code>
					</div>
				</div>

				<h3>Compute divide result of two values: div(a, b)</h3>
				<div class="s3">
					<p>Return the numeric value of <code>a</code> divided by
					the value of <code>b</code>.</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>{div(5, 2)}</code>
					</div>
					<div class="code">
						<blockquote><span>Result:</span></blockquote>
<code>2.5</code>
					</div>
				</div>

				<h3>Test if two numeric values are equal: eq(a, b)</h3>
				<div class="s3">
					<p>Return true if a equals b, false false.</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>{eq(7, 7)}
{eq(1, 4)}</code>
					</div>
					<div class="code">
						<blockquote><span>Result:</span></blockquote>
<code>true
false</code>
					</div>
				</div>

				<h3>Remove pairs from an array: except(array1, array2, ...)</h3>
				<div class="s3">
					<p>Return an array containing all pairs from
					<code>array1</code> having a key that does not exist in
					<code>array2</code> and following arrays. This function can
					also be used to remove a single element from an array.</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>{dump except([1: "a", 2: "b", 3: "c"], [2: "x", 4: "y"])}</code>
					</div>
					<div class="code">
						<blockquote><span>Result:</span></blockquote>
<code>[1: "a", 3: "c"]</code>
					</div>
				</div>

				<h3>Find index of element in a value: find(value, token[, start])</h3>
				<div class="s3">
					<p>Find the 0-based index of given token in an array, or
					sub-string in a string. Search starts at index 0 unless the
					<code>start</code> argument is specified.</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>{find([89, 3, 572, 35, 7], 35)}
{find("hello, world!", "o", 5)}</code>
					</div>
					<div class="code">
						<blockquote><span>Result:</span></blockquote>
<code>3
8</code>
					</div>
				</div>

				<h3>Swap keys and values in an array: flip(array)</h3>
				<div class="s3">
					<p>Return an array were pairs are created by swapping each
					key and value pair from input array. If two or more values
					where equal in input array, then only the last one will be
					accessed directly. Using resulting array with the
					<code>for</code> command will still iterate through each
					pair even if there was duplicates.</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>{dump flip([1: "hello,", 2: "world!"])}
{dump flip(["a": 0, "b": 0])}</code>
					</div>
					<div class="code">
						<blockquote><span>Result:</span></blockquote>
<code>["hello,": 1, "world!": 2]
[0: "a", 0: "b"]</code>
					</div>
				</div>

				<h3>Test if numeric value is greater or equal to another: ge(a, b)</h3>
				<div class="s3">
					<p>Return true if a is greater or equal to b, false else.</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>{ge(7, 3)}
{ge(2, 2)}</code>
					</div>
					<div class="code">
						<blockquote><span>Result:</span></blockquote>
<code>true
true</code>
					</div>
				</div>

				<h3>Test if numeric value is greater than another: gt(a, b)</h3>
				<div class="s3">
					<p>Return true if a is greater that b, false else.</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>{gt(7, 3)}
{gt(2, 2)}</code>
					</div>
					<div class="code">
						<blockquote><span>Result:</span></blockquote>
<code>true
false</code>
					</div>
				</div>

				<h3>Check if an array value contains given key: has(array, key)</h3>
				<div class="s3">
					<p>Return true if given array has a value associated to
					given key, or false else.</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>{has(["name": "Paul", "age": 37, "sex": "M"], "age")}</code>
					</div>
					<div class="code">
						<blockquote><span>Result:</span></blockquote>
<code>true</code>
					</div>
				</div>

				<h3>Include and render template file: include(path[, vars[, vars...]])</h3>
				<div class="s3">
					<p>Parse document from a template file and render it with
					given variables. Variables should be array values, their
					keys will be used as assigned variable names.</p>
					<p>For the next example, we will assume that a file named
					"article.ctl" is available in current directory and
					contains this template code:</p>
					<div class="code">
						<blockquote><span>Template "article.ctl":</span></blockquote>
<code>&lt;div class="box"&gt;
    &lt;div class="title"&gt;{a.title}&lt;/div&gt;
    &lt;div class="text"&gt;{a.text}&lt;/div&gt;
&lt;/div&gt;</code>
					</div>
					<p>Now, we want to include and render this template file in
					our global rendering:</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>{for article in articles:
    {include("article.ctl", ["a": article])}
}</code>
					</div>
					<div class="code">
						<blockquote><span>C# code:</span></blockquote>
<code>scope["articles"] = new Value[]
{
    new Dictionary&lt;Value, Value&gt;
    {
        {"title", "First article"},
        {"text", "Lorem ipsum dolor sit amet, consectetur adipiscing elit."}
    },
    new Dictionary&lt;Value, Value&gt;
    {
        {"title", "Second article"},
        {"text", "Cras vitae erat dui, commodo gravida purus."}
    }
};</code>
					</div>
					<div class="code">
						<blockquote><span>Result:</span></blockquote>
<code>&lt;div class="box"&gt;
    &lt;div class="title"&gt;First article&lt;/div&gt;
    &lt;div class="text"&gt;Lorem ipsum dolor sit amet, consectetur adipiscing elit.&lt;/div&gt;
&lt;/div&gt;
&lt;div class="box"&gt;
    &lt;div class="title"&gt;Second article&lt;/div&gt;
    &lt;div class="text"&gt;Cras vitae erat dui, commodo gravida purus.&lt;/div&gt;
&lt;/div&gt;</code>
					</div>
					<p>By using <code>return</code> keyword in your included
					template, you can pass a value to the calling template (it
					will be available as the result of the call to function
					<code>include</code>).</p>
				</div>

				<h3>Join values from an array: join(array[, string])</h3>
				<div class="s3">
					<p>Concatenate all values from given array pairs, using
					given string as a separator (or empty string if no
					separator is provided).</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>{join(["2011", "01", "01"], "/")}</code>
					</div>
					<div class="code">
						<blockquote><span>Result:</span></blockquote>
<code>2011/01/01</code>
					</div>
				</div>

				<h3>Convert string to lowercase: lcase(string)</h3>
				<div class="s3">
					<p>Return a lowercase conversion of given string value.</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>{lcase("Mixed Case String"}</code>
					</div>
					<div class="code">
						<blockquote><span>Result:</span></blockquote>
<code>mixed case string</code>
					</div>
				</div>

				<h3>Get length of a value: len(a)</h3>
				<div class="s3">
					<p>Return the length or given value, that is number pairs
					if value was an array, or number of characters if value
					was a string.</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>{len("Hello!")}
{count([17, 22, 391, 44])}</code>
					</div>
					<div class="code">
						<blockquote><span>Result:</span></blockquote>
<code>6
4</code>
					</div>
				</div>

				<h3>Test if numeric value is lower than another: lt(a, b)</h3>
				<div class="s3">
					<p>Return true if a is lower that b, false else.</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>{lt(3, 7)}
{lt(2, 2)}</code>
					</div>
					<div class="code">
						<blockquote><span>Result:</span></blockquote>
<code>true
false</code>
					</div>
				</div>

				<h3>Test if numeric value is lower or equal to another: le(a, b)</h3>
				<div class="s3">
					<p>Return true if a is lower or equal to b, false else.</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>{le(3, 7)}
{le(2, 2)}</code>
					</div>
					<div class="code">
						<blockquote><span>Result:</span></blockquote>
<code>true
true</code>
					</div>
				</div>

				<h3>Applying function to each value in an array: map(array, callback[, a, b...])</h3>
				<div class="s3">
					<p>Return an array where values are built by applying given
					function to original array values, while preserving keys.
					Function <code>callback</code> is invoked for each value in
					<code>array</code> as its first argument.</p>
					<p>Optional arguments can be specified when calling
					<code>map</code> and will be passed to each invocation of
					<code>callback</code> as second, third, forth argument and
					so on.</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>{define square(x) as: {return mul(x, x)}}
{for v in map([1, 2, 3, 4], square): {v}}

{dump map([1, 7, 4, 5, 3, 2, 6], lt, 4)}</code>
					</div>
					<div class="code">
						<blockquote><span>Result:</span></blockquote>
<code>[0: 1, 1: 0, 2: 0, 3: 0, 4: 1, 5: 1, 6: 0]</code>
					</div>
				</div>

				<h3>Test if a string matches a regular expression: match(string, pattern)</h3>
				<div class="s3">
					<p>Return true if a string matches given regular expression
					pattern, or false else. See
					<a href="http://msdn.microsoft.com/en-us/library/hs600312(v=vs.71).aspx">.NET
					Framework Regular Expressions</a> for details.</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>{match("abc123", "^[a-z]+[0-9]+$")}</code>
					</div>
					<div class="code">
						<blockquote><span>Result:</span></blockquote>
<code>true</code>
					</div>
				</div>

				<h3>Get the maximum between 2 or more values: max(a[, b[, c...]])</h3>
				<div class="s3">
					<p>Return the highest numeric value among given ones. This
					function also works on an array, and will return its
					highest numeric value.</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>{max(6, 8, 5, 7, 1, 2)}
{max([6, 8, 5, 7, 1, 2])}</code>
					</div>
					<div class="code">
						<blockquote><span>Result:</span></blockquote>
<code>8
8</code>
					</div>
				</div>

				<h3>Get the minimum between 2 or more values: min(a[, b[, c...]])</h3>
				<div class="s3">
					<p>Return the lowest numeric value among given ones. This
					function also works on an array, and will return its
					lowest numeric value.</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>{min(6, 8, 5, 7, 1, 2)}
{min([6, 8, 5, 7, 1, 2])}</code>
					</div>
					<div class="code">
						<blockquote><span>Result:</span></blockquote>
<code>1
1</code>
					</div>
				</div>

				<h3>Compute reminder of two values: mod(a, b)</h3>
				<div class="s3">
					<p>Return the value of the first numeric argument modulo the
					second one.</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>{mod(7, 3)}</code>
					</div>
					<div class="code">
						<blockquote><span>Result:</span></blockquote>
<code>1</code>
					</div>
				</div>

				<h3>Compute product of two values: mul(a, b)</h3>
				<div class="s3">
					<p>Return the numeric value of a times b.</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>{mul(3, 4)}</code>
					</div>
					<div class="code">
						<blockquote><span>Result:</span></blockquote>
<code>12</code>
					</div>
				</div>

				<h3>Logical NOT: not(a)</h3>
				<div class="s3">
					<p>Perform logical "not" on given boolean value, i.e return
					true if value was false or false if it was true.</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>{not(eq(1, 2))}</code>
					</div>
					<div class="code">
						<blockquote><span>Result:</span></blockquote>
<code>true</code>
					</div>
				</div>

				<h3>Logical OR: or(a, b, ...)</h3>
				<div class="s3">
					<p>Perform logical "or" between given boolean values, i.e.
					return "true" if at least one argument is true.</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>{or(eq(2, 3), gt(5, 1))}</code>
					</div>
					<div class="code">
						<blockquote><span>Result:</span></blockquote>
<code>true</code>
					</div>
				</div>

				<h3>Get unicode value from character: ord(char)</h3>
				<div class="s3">
					<p>Get the unicode value of the first character of given
					string. See
					<a href="http://en.wikipedia.org/wiki/Unicode">Unicode on
					Wikipedia</a> for details.</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>{ord("a")}</code>
					</div>
					<div class="code">
						<blockquote><span>Result:</span></blockquote>
<code>97</code>
					</div>
				</div>

				<h3>Generate pseudo-random value: rand([a[, b]])</h3>
				<div class="s3">
					<p>Get a pseudo-random numeric value between 0 and
					2.147.483.647 inclusive. If <code>a</code> is
					specified, return a pseudo-random numeric value
					between 0 and <code>a</code> exclusive. If both
					<code>a</code> and <code>b</code> are specified,
					return a pseudo-random numeric value between
					<code>a</code> inclusive and <code>b</code>
					exclusive.</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>{rand()}
{rand(1, 7)}</code>
					</div>
					<div class="code">
						<blockquote><span>Result:</span></blockquote>
<code>542180393
5</code>
					</div>
				</div>

				<h3>Extract part of value: slice(value, index[, count])</h3>
				<div class="s3">
					<p>Extact slice from an array, or sub-string from a
					string. <code>count</code> pairs or characters are
					extracted from given 0-based <code>index</code>. If no
					<code>count</code> argument is specified, all elements
					starting from given <code>index</code> are extracted.</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>{for v in slice([68, 657, 54, 3, 12, 9], 3, 2): {v}}
{slice("abchello", 4)}</code>
					</div>
					<div class="code">
						<blockquote><span>Result:</span></blockquote>
<code>3 12
hello</code>
					</div>
				</div>

				<h3>Get sorted array: sort(array[, callback])</h3>
				<div class="s3">
					<p>Return a sorted copy of given array. First argument is
					the input array, and will be sorted using natural order
					(numerical or alphabetical, depending on value types) by
					default. You can specify a second argument as
					comparison delegate, that should accept two arguments and
					return -1 if the first should be placed "before" the
					second, 0 if they are equal, or 1 else.</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>{set shuffled to ["in", "order", "elements" "natural"]}

{for item in sort(shuffled):
    {item}
}

{define by_length(a, b) as:
    {return cmp(len(b), len(a))}
}

{set shuffled to ["by their", "are sorted", "length", "these strings"]}

{for item in sort(shuffled, by_length):
    {item}
}</code>
					</div>
					<div class="code">
						<blockquote><span>Result:</span></blockquote>
<code>elements
in
natural
order

these strings
are sorted
by their
length</code>
					</div>
				</div>

				<h3>Split string into array: split(input, separator)</h3>
				<div class="s3">
					<p>Split string <code>input</code> according to given
					string separator <code>separator</code>. Result is an
					array where pair values contain split sub-strings.</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>{dump split("2011/01/01", "/")}</code>
					</div>
					<div class="code">
						<blockquote><span>Result:</span></blockquote>
<code>[0: "2011", 1: "01", 2: "01"]</code>
					</div>
				</div>

				<h3>Compute difference between two values: sub(a, b)</h3>
				<div class="s3">
					<p>Return the numeric value of a minus b.</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>{sub(3, 5)}</code>
					</div>
					<div class="code">
						<blockquote><span>Result:</span></blockquote>
<code>-2</code>
					</div>
				</div>

				<h3>Convert string to uppercase: ucase(string)</h3>
				<div class="s3">
					<p>Return an uppercase conversion of given string
					value.</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>{ucase("Mixed Case String"}</code>
					</div>
					<div class="code">
						<blockquote><span>Result:</span></blockquote>
<code>MIXED CASE STRING</code>
					</div>
				</div>

				<h3>Get union of two arrays: union(array1, array2, ...)</h3>
				<div class="s3">
					<p>Return an array containing all pairs from input arrays,
					but without duplicating any key. If a key exists in more
					than one input array, the one from last array will
					overwrite any previous one.</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>{dump union([1: "a", 2: "b"], [2: "x", 3: "c"], [4: "d"])}</code>
					</div>
					<div class="code">
						<blockquote><span>Result:</span></blockquote>
<code>[1: "a", 2: "x", 3: "c", 4: "d"]</code>
					</div>
				</div>

				<h3>Get value depending on a conditional test: when(test[, true_part[, false_part]])</h3>
				<div class="s3">
					<p>Return <code>true_part</code> if <code>test</code> would
					have satisfied an <code>if</code> condition, or
					<code>false_part</code> else (or a undefined value if
					<code>false_part</code> is missing).</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>{set x to 3}
{set y to 0}
{dump when(x, "x is true", "x is false")}
{dump when(y, "y is true", "y is false")}</code>
					</div>
					<div class="code">
						<blockquote><span>Result:</span></blockquote>
<code>"x is true"
"y is false"</code>
					</div>
				</div>

				<h3>Logical exclusive OR: xor(a, b, ...)</h3>
				<div class="s3">
					<p>Perform logical "xor" between given boolean values, i.e.
					return "true" if exactly one argument is true and all the
					others are false.</p>
					<div class="code">
						<blockquote><span>Template:</span></blockquote>
<code>{xor(lt(2, 3), eq(1, 2))}</code>
					</div>
					<div class="code">
						<blockquote><span>Result:</span></blockquote>
<code>true</code>
					</div>
				</div>
			</div>

			<h2>Contact</h2>
			<div class="s2">
				<p>Contact me by e-mail: cottle [at] mirari [dot] fr</p>
				<p><a href="http://remi.caput.fr/">RCa</a>, 2011</p>
			</div>
		</div>

		<script type="text/javascript">
<!--
(function (target, source, depth)
{
	var	anchor;
	var child;
	var current;
	var	next;
	var	node;
	var parent;
	var stack;
	var unique;

	stack =
	[{
		elements	: source.childNodes,
		index		: 0,
		num			: 0
	}];

	unique = 0;

	while (stack.length > 0)
	{
		current = stack[stack.length - 1];

		if (current.index < current.elements.length)
		{
			node = current.elements[current.index++];

			if (node.tagName !== undefined && node.tagName.length == 2 && node.tagName[0] == 'H')
			{
				++current.num;

				next = parseInt (node.tagName.substr (1));

				for (; next < depth; --depth)
					target = target.parentNode.parentNode;

				node.innerHTML = ' ' + node.innerHTML;

				for (var i = stack.length; i-- > 0; )
					node.innerHTML = stack[i].num + '.' + node.innerHTML;

				anchor = document.createElement ('a');
				anchor.innerHTML = node.innerHTML;
				anchor.href = '#toc' + unique;

				child = document.createElement ('li');
				child.appendChild (anchor);

				node.id = 'toc' + unique;

				++unique;

				for (; next > depth; ++depth)
				{
					parent = undefined;

					for (var j = 0; j < target.childNodes.length; ++j)
					{
						if (target.childNodes[j].tagName !== undefined)
							parent = target.childNodes[j];
					}

					target = document.createElement ('ul');
					target.appendChild (child);

					if (parent !== undefined)
						parent.appendChild (target);
				}

				target.appendChild (child);
			}

			if (node.childNodes !== undefined)
			{
				stack.push
				({
					elements	: node.childNodes,
					index		: 0,
					num			: 0
				});
			}
		}
		else
			stack.pop ();
	}
}) (document.getElementById ('toc-data'), document.getElementById ('toc-from'), 1);
-->
		</script>
	</body>
</html>
